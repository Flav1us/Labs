package main;

/*********************************
Компьютерный практикум №3
ФІ-43, А. Малышко, В. Лещенко
*******************************/

import java.util.ArrayList;

public class L2Breaker {
	static int llen = 26;
	//static String sz = "10101010100010000001001011001101001011010110011011011010001000111101101000000010000110110011110100011100111101111111111001000001110100000100111111101010010010001111101011010110001001111111011100110111101000010010110101010101001100010100111001101111100000100011101011010101000001111110101011101010010101000100000101000000001111100011101110100100111000010010011101001011101001000011110010010011001101100100000110101010100010011110101000000000010010101100010111000101110100000101001000101111010110110000111011011011001111000010011010001011111010101111001110011111001111011100111000011000111100011110110111110100000110011001000100101011111011101110111011001111011110010110010111011000000111100110111010011000010001101011110011111010111100101110100000110101001101101110010011000111110000100110001100010101001011000100101001100101110101111100111111001100100101010010100010000011110010100010001101011011001111110101001001001011010001011000001000000001011110110100000000100110000010110011000000011001111001110011100111101000011101100101101110011001110111110100101101011000100010010010110110010000100110100111000101110010010100101011011011110000001101100010000101011000000001010110000000010101011100110000100101011101100000001111101101000000001100011011001010101000111110111100001101111101111100101100111000000111010100100100010110111011000110000001101011011011011001010010011010100101111010111000110100101010011111100101110101011001111010101101100001001001101110000110100100000001000001110101010010000011111111001000101101011101101011100110010101011100111111101000111111001101001001111101110100111000110001111001100100100001011101001011001100100111010010000010010100011101100010001000110000101011100101100100111010001110001001010110010011111111101010010101101101011001100001000011001000100110110010111000011101011111000100100111101110111010111010000100110010100001010000111011010011010011100111001101100111111110100010001101101010000011001010001110110000111101001110001110010010100001111000000010101110111111011010001101001101010000000011010010101000011001";
	static String sz = RandSeqGen.sz;
	static boolean[] z;
	static int[]
	lpoly = {0, 20, 24, 25, 26};
	static int N = /*230*/RandSeqGen.dN2;
	static double C = /*75*/RandSeqGen.dC2;
	
	static ArrayList<boolean[]> filter() {
		System.out.println("Breaking L2");
		ArrayList<boolean[]> res = new ArrayList<>();
		long start_timer = System.currentTimeMillis();
		boolean[] y;
		z = stringToBoolArr(sz);
		int n = llen;
		boolean[] x = new boolean[n];
		int R = 0;
		LR l = new LR(new boolean[llen], lpoly);
		for(int i=1; i<Math.pow(2, n); i++) {
			for(int j=n-1; j>=0; j--) { //от конца к началу, если 0 то меняем на 1 и заканчиваем, если 1 - меняем на 0 и продолжаем
				if(x[j]==false) {
					//change = j;
					x[j] = true;
					break;
				}
				x[j] = false;
			}
			l.init = x.clone();
			y = l.generSeq(N);
			for(int j=0; j<y.length; j++) {
				if(y[j]^z[j]) R++;
			}
			if(R<C) {
				System.out.println("possible answer found:\t" + R + " < " + C + "\t" + RandSeqGen.lpad(Integer.toBinaryString(i), llen) + "\ton iter " + i);
				res.add(x.clone());
			}
			R = 0;
			if(i%(int)(Math.pow(2, n)/10) == 0) System.out.println((System.currentTimeMillis() - start_timer)/1000 + " s");
		}
		return res;
	}
	
	public static boolean[] stringToBoolArr(String s) throws IllegalArgumentException {
		boolean[] b = new boolean[s.length()];
		for(int i=0; i<b.length; i++) {
			if(s.charAt(i) == '0') b[i] = false;
			else if(s.charAt(i) == '1') b[i] = true;
			else throw new IllegalArgumentException("String should contain '0' or '1'. Found '" + s.charAt(i)+ "'.");
		}
		return b;
	}
}
